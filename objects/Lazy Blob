Create Event
x=room_width/2
y=room_height/2+15

los=200
rspeed=5
distance_to_player=1000
active=false
can_shoot=false
xPointOfInterest=x+1
yPointOfInterest=y
image_speed=0
cool_down=0
spd=1
lenX=28 // the different between player centre to the tip of the gun
lenY=0

Step Event
istance_to_player=distance_to_object(obj_player)

player_width=sprite_get_width(obj_player.sprite_index)
player_height=sprite_get_height(obj_player.sprite_index)
player_average_size=(player_width+player_height)/2

if(distance_to_player<=los)
{
	xPointOfInterest=obj_player.x
	yPointOfInterest=obj_player.y
	
	active=true
}
else
{
	active=false
}
ANG=point_direction(x,y,obj_player.x,obj_player.y)-image_angle
if(ANG>=360)
{
	ANG=ANG mod 360
}
if(active=true)
{
	if(ANG < (player_average_size/4) or ANG > (360-player_average_size/4))
	{
		can_shoot=true
		image_speed=spd
	}
	else
	{
		can_shoot=false
	}
}
else
{
	can_shoot=false
}

if(can_shoot==false)
{
	if(image_speed>0)
	{
		image_speed-=0.2
	}
}
	
pointdir=point_direction(x,y,xPointOfInterest,yPointOfInterest)
image_angle+=sin(degtorad(pointdir-image_angle))*rspeed
if((can_shoot==true)&& (cool_down<1))
{
	var bullet_id
	bullet_id=instance_create_layer(x+lengthdir_x(lenX,image_angle)-lengthdir_y(lenY,image_angle),y+lengthdir_y(lenX,image_angle)+lengthdir_x(lenY,image_angle),"Bullet_layer",obj_bullet)
	cool_down=30
}
cool_down=cool_down-.5
